import{R,u as I,a as P,b as l,c as F,j as e,d as B,e as w,i as c,r as W,C as H,f as T,g as k,h as O,F as Q,k as U}from"./index.e999ac47.js";import{C as x}from"./common.module.d7e709a7.js";import{C as S}from"./Card.7282f556.js";import{R as C}from"./index.c6ae74a7.js";import{D as v}from"./index.d57ce8fb.js";import{I as j}from"./index.f30be7d6.js";import{u as N}from"./useCraneUrl.91338662.js";import{u as M,a as $,b as q}from"./useIsValidPanel.f2e47360.js";import"./Check.d127d56e.js";import"./DateRangePicker.128e9774.js";const E=R.memo(()=>{var o;const t=I(),{t:r}=P(),n=l(i=>i.insight.customRange),s=l(i=>i.insight.window),a=l(i=>i.insight.discount),u=F();return e("div",{className:B(x.pageWithPadding,x.pageWithColor),children:w(S,{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[w("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:"1rem",marginTop:5,marginBottom:5},children:[e("div",{style:{marginRight:"0.5rem",width:"70px"},children:r("\u65F6\u95F4\u8303\u56F4")}),e("div",{style:{marginRight:"0.5rem"},children:e(C.Group,{value:s,onChange:i=>{t(c.window(i));const[d,g]=W[i];t(c.customRange({start:d.toDate().toISOString(),end:g.toDate().toISOString()}))},children:u.map(i=>e(C.Button,{value:i.value,children:i.text},i.value))})}),e(v,{mode:"date",style:{marginRight:"0.5rem"},value:n==null?void 0:n.start,onChange:i=>{t(c.window(null)),t(c.customRange({...n,start:i}))}}),e(v,{mode:"date",style:{marginRight:"0.5rem"},value:(o=n==null?void 0:n.end)!=null?o:null,onChange:i=>{t(c.window(null)),t(c.customRange({...n,end:i}))}})]}),w("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:"1rem",marginTop:5,marginBottom:5},children:[e("div",{style:{marginRight:"1rem",width:"70px"},children:r("Discount")}),e(j,{min:0,theme:"column",value:a,onChange:i=>{t(c.discount(i))}})]})]})})}),G=R.memo(({panel:t,selectedDashboard:r})=>{var h,m,y;const n=l(p=>p.config.chartBaselineHeight),s=l(p=>p.config.chartDefaultHeight),a=l(p=>p.insight.selectedNamespace),u=N(),o=M({panel:t}),i=$({selectedDashboard:r}),d=q({panelId:t.id,selectedDashboard:r}),g=((h=t==null?void 0:t.gridPos)==null?void 0:h.w)>0&&((m=t==null?void 0:t.gridPos)==null?void 0:m.w)<=24?Math.floor(t.gridPos.w/2):6,f=(y=t==null?void 0:t.gridPos)!=null&&y.h?Math.max(t.gridPos.h*n,s):s;return i&&!a||!o?null:e(H,{span:g,children:e(S,{style:{marginBottom:"0.5rem",marginTop:"0.5rem",height:f},children:e("iframe",{frameBorder:"0",height:"100%",src:`${u}/grafana/d-solo/${r==null?void 0:r.uid}/costs-by-dimension?${d}`,width:"100%"})})},t.id)});var D=T.exports.memo(()=>{var u,o,i,d,g,f,h;const{t}=P(),r=N(),n=k({craneUrl:r},{skip:!r}),s=((u=n==null?void 0:n.data)!=null?u:[]).find(m=>m.uid==="namespace-costs"),a=O({dashboardUid:s==null?void 0:s.uid},{skip:!(s!=null&&s.uid)});return w(Q,{children:[e(E,{}),e(U,{style:{marginTop:10},children:!(s!=null&&s.uid)||((d=(i=(o=a==null?void 0:a.data)==null?void 0:o.dashboard)==null?void 0:i.panels)==null?void 0:d.length)===0?e("span",{children:t("\u6682\u65E0\u6570\u636E")}):((h=(f=(g=a==null?void 0:a.data)==null?void 0:g.dashboard)==null?void 0:f.panels)!=null?h:[]).map(m=>e(G,{panel:m,selectedDashboard:s},m.id))})]})});export{D as default};
