import{f as l,a as B,j as e,e as p,k as y,C as i,Q as W,Y as q,P as w,R as I,bM as U,bN as Q,ar as V,F as C,az as f,d as J}from"./index.698c2779.js";import{C as D}from"./common.module.d7e709a7.js";import{F as K}from"./index.5f769ecb.js";import{j as G}from"./js-yaml.2f0635e4.js";import{u as H}from"./useCraneUrl.83474cdd.js";import{T as X}from"./index.2377762c.js";import{S as T}from"./index.b744f88b.js";import{D as A}from"./index.189b4c23.js";import"./index.c7534671.js";import"./DateRangePicker.0c983cde.js";import"./Check.a5ba0696.js";import"./index.7cfe99f0.js";const Z=[{value:"Resource",label:"Resource"},{value:"Replicas",label:"Replicas"}],{FormItem:_}=K,ee=({setFilterParams:n})=>{const{t:u}=B(),s=l.exports.useRef();return e("div",{className:"list-common-table-query",children:e(K,{ref:s,onValuesChange:(S,a)=>{console.log(a),a.name||delete a.name,a.recommenderType||delete a.recommenderType,n(a)},onReset:()=>{n({})},labelWidth:80,children:p(y,{children:[e(i,{flex:"1",children:p(y,{gutter:16,children:[e(i,{children:e(_,{label:u("\u63A8\u8350\u540D\u79F0"),name:"name",children:e(W,{placeholder:u("\u8BF7\u8F93\u5165\u63A8\u8350\u540D\u79F0(\u652F\u6301\u524D\u7F00\u6A21\u7CCA)"),autoWidth:!0})})}),e(i,{children:e(_,{label:u("\u63A8\u8350\u7C7B\u578B"),name:"recommenderType",children:e(q,{options:Z,placeholder:u("\u8BF7\u9009\u62E9\u63A8\u8350\u7C7B\u578B")})})})]})}),e(i,{flex:"160px",children:e(w,{type:"reset",variant:"base",theme:"default",style:{margin:"0px 50px"},children:u("\u91CD\u7F6E")})})]})})})};var te=l.exports.memo(ee);const re=I.lazy(()=>U(()=>import("./Editor.eb98ca79.js"),["assets/Editor.eb98ca79.js","assets/index.698c2779.js"])),ne=()=>{var E,R;const{t:n}=B(),[u,s]=l.exports.useState(!1),[d,c]=l.exports.useState(null),[S,a]=l.exports.useState([0,1]),[N,P]=l.exports.useState(!1),[o,z]=l.exports.useState({recommenderType:void 0,name:void 0}),L=H(),{data:h,isFetching:j,isError:F,isSuccess:Y,error:v}=Q({craneUrl:L});let g;Y?g=((E=h==null?void 0:h.data)==null?void 0:E.items)||[]:(g=[],F&&V.error(`${v.status} ${v.error}`));const x=g.filter(t=>(console.log(t),o!=null&&o.name?new RegExp(`${o.name}.*`).test(t.name):!0)).filter(t=>o!=null&&o.recommenderType?(o==null?void 0:o.recommenderType)===t.recommenderType:!0);function $(t){a(t)}function M(){P(!1)}const O=t=>{let r=null;try{r=G.dump(t)}catch{}return r};return p(C,{children:[e(y,{justify:"start",style:{marginBottom:"20px"},children:e(i,{children:e(te,{filterParams:o,setFilterParams:z})})}),e(X,{loading:j||F,data:x,columns:[{title:n("\u540D\u79F0"),colKey:"metadata.name"},{title:n("\u63A8\u8350\u7C7B\u578B"),ellipsis:!0,colKey:"spec.recommenders",cell({row:t}){return e(T,{direction:"vertical",children:t.spec.recommenders.map(r=>r.name==="Replicas"?e(f,{theme:"warning",variant:"light",children:r.name}):r.name==="Resource"?e(f,{theme:"primary",variant:"light",children:r.name}):e(C,{}))})}},{title:n("\u63A8\u8350\u76EE\u6807"),width:300,ellipsis:!0,colKey:"spec.resourceSelectors",cell({row:t}){const{resourceSelectors:r}=t.spec;return e(T,{direction:"vertical",children:r.map((m,k)=>{var b;return p(f,{theme:"success",variant:"light",children:[m.kind,m.name?" / ":"",(b=m.name)!=null?b:""]},k)})})}},{title:n("Namespace \u9009\u62E9\u5668"),ellipsis:!0,colKey:"spec.namespaceSelector",cell({row:t}){const r=t.spec.namespaceSelector;return r!=null&&r.any?"Any":r.matchNames}},{title:n("\u8FD0\u884C\u95F4\u9694"),ellipsis:!0,colKey:"spec.runInterval"},{title:n("\u521B\u5EFA\u65F6\u95F4"),ellipsis:!0,colKey:"metadata.creationTimestamp",cell({row:t}){const r=new Date(t.metadata.creationTimestamp);return`${r.toLocaleDateString()} ${r.toLocaleTimeString()}`}},{align:"left",fixed:"right",width:200,colKey:"op",title:n("\u64CD\u4F5C"),cell(t){return e(C,{children:e(w,{theme:"primary",variant:"text",onClick:()=>{c(t.row),s(!0)},children:n("\u67E5\u770BYAML")})})}}],rowKey:"index",selectedRowKeys:S,hover:!0,onSelectChange:$,pagination:{defaultCurrent:1,defaultPageSize:10,total:x.length,showJumper:!0,onChange(t){console.log(t,"onChange pageInfo")},onCurrentChange(t,r){console.log(t,"onCurrentChange current"),console.log(r,"onCurrentChange pageInfo")},onPageSizeChange(t,r){console.log(t,"onPageSizeChange size"),console.log(r,"onPageSizeChange pageInfo")}}}),e(A,{header:n("\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u63A8\u8350\u89C4\u5219\uFF1F"),visible:N,onClose:M,children:e("p",{children:n("\u63A8\u8350\u89C4\u5219\u5C06\u4ECEAPI Server\u4E2D\u5220\u9664,\u4E14\u65E0\u6CD5\u6062\u590D")})}),e(A,{top:"15vh",width:850,visible:u,onClose:()=>{s(!1),c(null)},cancelBtn:null,onConfirm:()=>{s(!1),c(null)},children:e(I.Suspense,{fallback:"loading",children:e(re,{value:d&&(R=O(d))!=null?R:""})})})]})},oe=()=>e("div",{className:J(D.pageWithPadding,D.pageWithColor),children:e(ne,{})});var fe=l.exports.memo(oe);export{ne as SelectTable,fe as default};
