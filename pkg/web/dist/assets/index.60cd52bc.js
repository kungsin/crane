import{f as l,a as b,j as e,e as x,k as p,C as d,Q as j,P as h,R as w,bM as N,d as U,as as Y,bO as q,bP as M,ar as P,F as W,ay as O,az as Q}from"./index.3b561666.js";import{u as J}from"./useCraneUrl.ac6187d2.js";import{j as V}from"./js-yaml.2f0635e4.js";import{C as D}from"./common.module.d7e709a7.js";import{F as E}from"./index.092ec01f.js";import{T as G}from"./index.8880e189.js";import{S as H}from"./index.1cb69f0e.js";import{D as T}from"./index.f9439e83.js";import"./index.0420192b.js";import"./DateRangePicker.129f4a98.js";import"./Check.92a180f9.js";import"./index.87084703.js";const{FormItem:X}=E,Z=({setFilterParams:a})=>{const{t:s}=b();return e("div",{className:"list-common-table-query",children:e(E,{onValuesChange:(u,r)=>{r.name||delete r.name,r.namespace||delete r.namespace,r.workloadType||delete r.workloadType,a(r)},onReset:()=>a({}),labelWidth:80,layout:"inline",children:x(p,{children:[e(d,{children:e(p,{children:e(d,{children:e(X,{label:s("\u63A8\u8350\u540D\u79F0"),name:"name",children:e(j,{placeholder:s("\u8BF7\u8F93\u5165\u63A8\u8350\u540D\u79F0")})})})})}),e(d,{children:e(h,{type:"reset",variant:"base",theme:"default",children:s("\u91CD\u7F6E")})})]})})})};var ee=l.exports.memo(Z);const te=w.lazy(()=>N(()=>import("./Editor.6bb1d0d4.js"),["assets/Editor.6bb1d0d4.js","assets/index.3b561666.js"])),oe=()=>{var S,v;const{t:a}=b(),[s,i]=l.exports.useState(!1),[g,u]=l.exports.useState(null),r=Y(),[R,_]=l.exports.useState([0,1]),[k,B]=l.exports.useState(!1),[o,A]=l.exports.useState({namespace:void 0,workloadType:void 0,name:void 0}),C=J(),{data:c,isFetching:K,isError:f,isSuccess:I,error:y}=q({craneUrl:C,recommendationType:M.IdleNode},{skip:!C});let m;I?m=((S=c==null?void 0:c.data)==null?void 0:S.items)||[]:(m=[],f&&P.error(`${y.status} ${y.error}`)),console.log(c);const F=m.filter(t=>o!=null&&o.name?new RegExp(`${o.name}.*`).test(t.name):!0).filter(t=>o!=null&&o.workloadType?(o==null?void 0:o.workloadType)===t.workloadType:!0).filter(t=>o!=null&&o.namespace?(o==null?void 0:o.namespace)===(t==null?void 0:t.namespace):!0);function $(t){_(t)}function z(){B(!1)}const L=t=>{let n=null;try{n=V.dump(t)}catch{}return console.log(n),n};return x(W,{children:[e(p,{children:e(h,{onClick:()=>r("/recommend/recommendationRule"),children:a("\u67E5\u770B\u63A8\u8350\u89C4\u5219")})}),e(O,{}),e(p,{justify:"start",style:{marginBottom:"20px"},children:e(d,{children:e(ee,{recommendation:m,setFilterParams:A})})}),e(G,{loading:K||f,data:F,verticalAlign:"middle",columns:[{title:a("\u540D\u79F0"),colKey:"metadata.name",ellipsis:!0},{title:a("\u8282\u70B9\u540D"),colKey:"spec.targetRef.name"},{title:a("\u76EE\u6807\u7C7B\u578B"),ellipsis:!0,colKey:"spec.targetRef",cell({row:t}){const{targetRef:n}=t.spec;return e(H,{direction:"vertical",children:e(Q,{theme:"success",variant:"light",children:n.kind})})}},{title:a("\u521B\u5EFA\u65F6\u95F4"),ellipsis:!0,colKey:"metadata.creationTimestamp",cell({row:t}){const n=new Date(t.metadata.creationTimestamp);return`${n.toLocaleDateString()} ${n.toLocaleTimeString()}`}},{title:a("\u66F4\u65B0\u65F6\u95F4"),ellipsis:!0,colKey:"status.lastUpdateTime",cell({row:t}){const n=new Date(t.status.lastUpdateTime);return`${n.toLocaleDateString()} ${n.toLocaleTimeString()}`}},{align:"left",fixed:"right",width:200,colKey:"op",title:a("\u64CD\u4F5C"),cell(t){return e(h,{theme:"primary",variant:"text",onClick:()=>{u(t.row),i(!0)},children:a("\u67E5\u770BYAML")})}}],rowKey:"index",selectedRowKeys:R,hover:!0,onSelectChange:$,pagination:{defaultCurrent:1,defaultPageSize:10,total:F.length,showJumper:!0,onChange(t){console.log(t,"onChange pageInfo")},onCurrentChange(t,n){console.log(t,"onCurrentChange current"),console.log(n,"onCurrentChange pageInfo")},onPageSizeChange(t,n){console.log(t,"onPageSizeChange size"),console.log(n,"onPageSizeChange pageInfo")}}}),e(T,{header:a("\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u63A8\u8350\u89C4\u5219\uFF1F"),visible:k,onClose:z,children:e("p",{children:a("\u63A8\u8350\u89C4\u5219\u5C06\u4ECEAPI Server\u4E2D\u5220\u9664,\u4E14\u65E0\u6CD5\u6062\u590D")})}),e(T,{top:"5vh",width:850,visible:s,onClose:()=>{i(!1),u(null)},cancelBtn:null,onConfirm:()=>{i(!1),u(null)},children:e(w.Suspense,{fallback:"loading",children:e(te,{value:g&&(v=L(g))!=null?v:""})})})]})},ne=()=>e("div",{className:U(D.pageWithPadding,D.pageWithColor),children:e(oe,{})});var fe=l.exports.memo(ne);export{fe as default};
