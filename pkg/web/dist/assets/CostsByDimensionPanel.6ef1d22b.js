import{R,u as B,a as P,b as l,c as N,j as n,d as F,e as w,i as c,r as W,C as H,f as T,g as k,h as O,F as Q,k as U}from"./index.698c2779.js";import{C as x}from"./common.module.d7e709a7.js";import{C as S}from"./Card.0269d18d.js";import{R as C}from"./index.7cfe99f0.js";import{D as v}from"./index.ed1c023e.js";import{I as j}from"./index.c7534671.js";import{u as I}from"./useCraneUrl.83474cdd.js";import{u as M,a as $,b as q}from"./useIsValidPanel.18ece626.js";import"./Check.a5ba0696.js";import"./DateRangePicker.0c983cde.js";const E=R.memo(()=>{var a;const i=B(),{t:r}=P(),e=l(t=>t.insight.customRange),s=l(t=>t.insight.window),o=l(t=>t.insight.discount),d=N();return n("div",{className:F(x.pageWithPadding,x.pageWithColor),children:w(S,{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[w("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:"1rem",marginTop:5,marginBottom:5},children:[n("div",{style:{marginRight:"0.5rem",width:"70px"},children:r("\u65F6\u95F4\u8303\u56F4")}),n("div",{style:{marginRight:"0.5rem"},children:n(C.Group,{value:s,onChange:t=>{i(c.window(t));const[u,g]=W[t];i(c.customRange({start:u.toDate().toISOString(),end:g.toDate().toISOString()}))},children:d.map(t=>n(C.Button,{value:t.value,children:t.text},t.value))})}),n(v,{mode:"date",style:{marginRight:"0.5rem"},value:e==null?void 0:e.start,onChange:t=>{i(c.window(null)),i(c.customRange({...e,start:t}))}}),n(v,{mode:"date",style:{marginRight:"0.5rem"},value:(a=e==null?void 0:e.end)!=null?a:null,onChange:t=>{i(c.window(null)),i(c.customRange({...e,end:t}))}})]}),w("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:"1rem",marginTop:5,marginBottom:5},children:[n("div",{style:{marginRight:"1rem",width:"70px"},children:r("Discount")}),n(j,{min:0,theme:"column",value:o,onChange:t=>{i(c.discount(t))}})]})]})})}),G=R.memo(({panel:i,selectedDashboard:r})=>{var h,m,y;const e=l(f=>f.config.chartBaselineHeight),s=l(f=>f.config.chartDefaultHeight),o=l(f=>f.insight.selectedNamespace),d=I(),a=M({panel:i}),t=$({selectedDashboard:r}),u=q({panelId:i.id,selectedDashboard:r}),g=((h=i==null?void 0:i.gridPos)==null?void 0:h.w)>0&&((m=i==null?void 0:i.gridPos)==null?void 0:m.w)<=24?Math.floor(i.gridPos.w/2):6,p=(y=i==null?void 0:i.gridPos)!=null&&y.h?Math.max(i.gridPos.h*e,s):s;return t&&!o||!a?null:n(H,{span:g,children:n(S,{style:{marginBottom:"0.5rem",marginTop:"0.5rem",height:p},children:n("iframe",{frameBorder:"0",height:"100%",src:`${d}/grafana/d-solo/${r==null?void 0:r.uid}/costs-by-dimension?${u}`,width:"100%"})})},i.id)});var _=T.exports.memo(()=>{var d,a,t,u,g,p,h;const{t:i}=P(),r=I(),e=k({craneUrl:r},{skip:!r}),s=((d=e==null?void 0:e.data)!=null?d:[]).find(m=>m.uid==="cost-dimension"),o=O({dashboardUid:s==null?void 0:s.uid},{skip:!(s!=null&&s.uid)});return w(Q,{children:[n(E,{}),n(U,{style:{marginTop:10},children:!(s!=null&&s.uid)||((u=(t=(a=o==null?void 0:o.data)==null?void 0:a.dashboard)==null?void 0:t.panels)==null?void 0:u.length)===0?n("span",{children:i("\u6682\u65E0\u6570\u636E")}):((h=(p=(g=o==null?void 0:o.data)==null?void 0:g.dashboard)==null?void 0:p.panels)!=null?h:[]).map(m=>n(G,{panel:m,selectedDashboard:s},m.id))})]})});export{_ as default};
