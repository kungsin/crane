import{R,u as N,a as P,b as u,c as F,j as r,d as B,e as p,i as c,r as O,C as W,f as H,g as T,h as U,F as k,k as Q}from"./index.698c2779.js";import{C as v}from"./common.module.d7e709a7.js";import{C as S}from"./Card.0269d18d.js";import{R as x}from"./index.7cfe99f0.js";import{D as C}from"./index.ed1c023e.js";import{I as j}from"./index.c7534671.js";import{u as I}from"./useCraneUrl.83474cdd.js";import{u as M,a as $,b as q}from"./useIsValidPanel.18ece626.js";import"./Check.a5ba0696.js";import"./DateRangePicker.0c983cde.js";const E=R.memo(()=>{var a;const i=N(),{t:n}=P(),s=u(t=>t.insight.customRange),e=u(t=>t.insight.window),o=u(t=>t.insight.discount),d=F();return r("div",{className:B(v.pageWithPadding,v.pageWithColor),children:p(S,{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[p("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:"1rem",marginTop:5,marginBottom:5},children:[r("div",{style:{marginRight:"0.5rem",width:"70px"},children:n("\u65F6\u95F4\u8303\u56F4")}),r("div",{style:{marginRight:"0.5rem"},children:r(x.Group,{value:e,onChange:t=>{i(c.window(t));const[l,g]=O[t];i(c.customRange({start:l.toDate().toISOString(),end:g.toDate().toISOString()}))},children:d.map(t=>r(x.Button,{value:t.value,children:t.text},t.value))})}),r(C,{mode:"date",style:{marginRight:"0.5rem"},value:s==null?void 0:s.start,onChange:t=>{i(c.window(null)),i(c.customRange({...s,start:t}))}}),r(C,{mode:"date",style:{marginRight:"0.5rem"},value:(a=s==null?void 0:s.end)!=null?a:null,onChange:t=>{i(c.window(null)),i(c.customRange({...s,end:t}))}})]}),p("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginRight:"1rem",marginTop:5,marginBottom:5},children:[r("div",{style:{marginRight:"1rem",width:"70px"},children:n("Discount")}),r(j,{min:0,theme:"column",value:o,onChange:t=>{i(c.discount(t))}})]})]})})}),G=R.memo(({panel:i,selectedDashboard:n})=>{var h,m,y;const s=u(f=>f.config.chartBaselineHeight),e=u(f=>f.config.chartDefaultHeight),o=u(f=>f.insight.selectedNamespace),d=I(),a=M({panel:i}),t=$({selectedDashboard:n}),l=q({panelId:i.id,selectedDashboard:n}),g=((h=i==null?void 0:i.gridPos)==null?void 0:h.w)>0&&((m=i==null?void 0:i.gridPos)==null?void 0:m.w)<=24?Math.floor(i.gridPos.w/2):6,w=(y=i==null?void 0:i.gridPos)!=null&&y.h?Math.max(i.gridPos.h*s,e):e;return t&&!o||!a?null:r(W,{span:g,children:r(S,{style:{marginBottom:"0.5rem",marginTop:"0.5rem",height:w},children:r("iframe",{frameBorder:"0",height:"100%",src:`${d}/grafana/d-solo/${n==null?void 0:n.uid}/costs-by-dimension?${l}`,width:"100%"})})},i.id)});var _=H.exports.memo(()=>{var d,a,t,l,g,w,h;const{t:i}=P(),n=I();console.log("craneUrl",n);const s=T({craneUrl:n},{skip:!n});console.log("dashboardList",s);const e=((d=s==null?void 0:s.data)!=null?d:[]).find(m=>m.uid==="cluster-overview");console.log("selectedDashboard",e);const o=U({dashboardUid:e==null?void 0:e.uid},{skip:!(e!=null&&e.uid)});return console.log("dashboardDetail",o),p(k,{children:[r(E,{}),r(Q,{style:{marginTop:10},children:!(e!=null&&e.uid)||((l=(t=(a=o==null?void 0:o.data)==null?void 0:a.dashboard)==null?void 0:t.panels)==null?void 0:l.length)===0?r("span",{children:i("\u6682\u65E0\u6570\u636E")}):((h=(w=(g=o==null?void 0:o.data)==null?void 0:g.dashboard)==null?void 0:w.panels)!=null?h:[]).map(m=>r(G,{panel:m,selectedDashboard:e},m.id))})]})});export{_ as default};
