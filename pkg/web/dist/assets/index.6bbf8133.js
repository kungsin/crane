import{b as me,l as ye,f as d,at as E,au as M,R as h,a as k,ar as ae,j as o,e as y,av as he,d as S,aq as se,aw as H,k as P,C,a1 as c,a7 as ke}from"./index.698c2779.js";import{u as ue}from"./useCraneUrl.83474cdd.js";import{C as le,E as ie,S as w}from"./index.ed6e5a77.js";import{a as fe}from"./index.ed1c023e.js";import"./DateRangePicker.0c983cde.js";import"./index.c7534671.js";const ce=()=>{var r,n,s,_;const e=me(u=>u.insight.selectedClusterId);return(_=((s=(n=(r=ye({}).data)==null?void 0:r.data)==null?void 0:n.items)!=null?s:[]).find(u=>u.id===e))==null?void 0:_.discount};function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K(Object(r),!0).forEach(function(n){M(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ge={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.46 12.46l-.92-.92L9.08 8 5.54 4.46l.92-.92L10.92 8l-4.46 4.46z",fillOpacity:.9}}]},_e=d.exports.forwardRef(function(e,t){return d.exports.createElement(E,Q(Q({},e),{},{id:"chevron-right",ref:t,icon:ge}))});_e.displayName="ChevronRightIcon";function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X(Object(r),!0).forEach(function(n){M(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Ce={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.98 10.31L7.3 8 5 5.69l.7-.7L8 7.28 10.31 5l.7.7L8.72 8l2.3 2.31-.7.7L8 8.72 5.69 11l-.7-.7z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M8 1a7 7 0 110 14A7 7 0 018 1zm0 1a6 6 0 100 12A6 6 0 008 2z",fillOpacity:.9}}]},$=d.exports.forwardRef(function(e,t){return d.exports.createElement(E,J(J({},e),{},{id:"close-circle",ref:t,icon:Ce}))});$.displayName="CloseCircleIcon";function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z(Object(r),!0).forEach(function(n){M(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.5 12V6.5h1V12h-1zM8.6 4H7.4v1.2h1.2V4z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M1 8a7 7 0 1014 0A7 7 0 001 8zm1 0a6 6 0 1112 0A6 6 0 012 8z",fillOpacity:.9}}]},de=d.exports.forwardRef(function(e,t){return d.exports.createElement(E,ee(ee({},e),{},{id:"info-circle",ref:t,icon:ve}))});de.displayName="InfoCircleIcon";function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?te(Object(r),!0).forEach(function(n){M(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Pe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.5 4v4.39L10 11l.7-.7-2.2-2.33V4h-1z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M15 8A7 7 0 111 8a7 7 0 0114 0zm-1 0A6 6 0 102 8a6 6 0 0012 0z",fillOpacity:.9}}]},pe=d.exports.forwardRef(function(e,t){return d.exports.createElement(E,ne(ne({},e),{},{id:"time",ref:t,icon:Pe}))});pe.displayName="TimeIcon";function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?re(Object(r),!0).forEach(function(n){M(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var xe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6 1c.53 0 1.02.12 1.46.35l-.63.8a2.24 2.24 0 00-3.08 2.1c0 1.23.98 2.22 2.2 2.25v1A3.25 3.25 0 016 1zM.54 9.44c1.65-.78 3.48-1.21 5.41-1.22v1c-1.77 0-3.44.4-4.95 1.1V12h1.86v1H.5a.5.5 0 01-.5-.5v-2.2c0-.36.2-.7.54-.86z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10 8.31a3.25 3.25 0 110-6.5 3.25 3.25 0 010 6.5zm0-1a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5zM16 11.52c0-.37-.2-.72-.54-.87a12.83 12.83 0 00-10.92 0 .96.96 0 00-.54.87V14c0 .28.22.5.5.5h11a.5.5 0 00.5-.5v-2.48zm-1 .01v1.97H5v-1.97a11.83 11.83 0 0110 0z"}}]},be=d.exports.forwardRef(function(e,t){return d.exports.createElement(E,oe(oe({},e),{},{id:"usergroup",ref:t,icon:xe}))});be.displayName="UsergroupIcon";const Oe="_boardPanelDark_y082s_1",De="_boardTitle_y082s_4",we="_boardItemLeft_y082s_5",Ie="_boardItemDesc_y082s_6",Fe="_trendColorUp_y082s_7",Ee="_trendColorDown_y082s_8",Me="_boardItemBottom_y082s_9",je="_trendIconUp_y082s_12",Ae="_trendIconDown_y082s_13",Be="_boardItem_y082s_5",Te="_boardItemIcon_y082s_37",Se="_trendIcon_y082s_12",$e="_trendColorError_y082s_70",Ne="_iconWrap_y082s_75",qe="_svgIcon_y082s_87",Re="_paneLineChart_y082s_91",Ue="_paneBarChart_y082s_99";var i={boardPanelDark:Oe,boardTitle:De,boardItemLeft:we,boardItemDesc:Ie,trendColorUp:Fe,trendColorDown:Ee,boardItemBottom:Me,trendIconUp:je,trendIconDown:Ae,boardItem:Be,boardItemIcon:Te,trendIcon:Se,trendColorError:$e,iconWrap:Ne,svgIcon:qe,paneLineChart:Re,paneBarChart:Ue},F=(e=>(e.Instant="Instant",e.Range="Range",e))(F||{});const Le=(e,{query:t,timeType:r,start:n,end:s,step:_})=>{if(typeof t!="string")return{error:"must be set query"};let u,m,p;switch(r){case"Instant":return u=H({craneUrl:e,query:t}),{result:u,error:""};case"Range":return u=se({craneUrl:e,start:n,end:s,step:_,query:t}),m=(Math.floor(Date.now()/1e3)-604800)*1e3,p=H({craneUrl:e,query:t,time:m}),{result:u,preResult:p,error:""};default:return{error:"must be set timeType"}}},Ye=({data:e},{title:t,timeType:r,lineColor:n="#0352d9"})=>{var _;const s={dataset:{dimensions:["timestamp",t],source:((_=e==null?void 0:e.data[0])==null?void 0:_.values)||[]},xAxis:{type:"time",show:!1},yAxis:{show:!1},grid:{top:0,left:0,right:0,bottom:0,tooltip:{show:!1}},color:[n],series:[{name:t,type:"line",smooth:!1,encode:{x:"timestamp",y:t},showSymbol:!1}]};if(e!=null&&e.emptyData)return{Icon:o("div",{className:i.iconWrap,children:o(be,{className:i.svgIcon})}),error:""};switch(r){case"Range":return{Icon:o("div",{className:i.paneLineChart,children:o(ie,{option:s,notMerge:!0,lazyUpdate:!0,style:{height:56}})}),error:""};case"Instant":return{Icon:{},error:""};default:return{Icon:"",error:"must be set timeType"}}},ze=({trend:e,trendNum:t})=>y("div",{className:S({[i.trendColorUp]:e===0,[i.trendColorDown]:e===1,[i.trendColorError]:e===2}),children:[o("div",{className:S(i.trendIcon,{[i.trendIconUp]:e===0,[i.trendIconDown]:e===1,[i.trendColorError]:e===2}),children:(r=>{switch(r){case 0:return y("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o("path",{d:"M4.5 8L8 4.5L11.5 8",stroke:"currentColor",strokeWidth:"1.5"}),o("path",{d:"M8 5V12",stroke:"currentColor",strokeWidth:"1.5"})]});case 1:return y("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o("path",{d:"M11.5 8L8 11.5L4.5 8",stroke:"currentColor",strokeWidth:"1.5"}),o("path",{d:"M8 11L8 4",stroke:"currentColor",strokeWidth:"1.5"})]});case 2:return o($,{});default:return o($,{})}})(e)}),t]});function Ve(e,t){return(e-t)/e*100}const Ge=({title:e,countPrefix:t,desc:r,Icon:n,dark:s,border:_,query:u,timeType:m,lineColor:p,start:f,end:g,step:x,tips:b})=>{var N,q,R,U,L,Y,z,V,G,W;const O=ue(),{t:v}=k();let l;try{l=Le(O,{query:u,timeType:m,start:f,end:g,step:x})}catch(I){l={error:I,result:{}},console.log(I)}const{result:a,error:j}=l;let D;!n&&(a==null?void 0:a.isFetching)!==!0&&(D=Ye(a,{title:e,timeType:m,lineColor:p}));let A=null;j?A=j:typeof(a==null?void 0:a.isFetching)=="boolean"&&(a==null?void 0:a.isFetching)===!0||typeof(a==null?void 0:a.isError)=="boolean"&&(a==null?void 0:a.isError)===!0||((N=a==null?void 0:a.data)==null?void 0:N.emptyData)?A="No Data":A=`${t||""}${((q=a==null?void 0:a.data)==null?void 0:q.latestValue)||""}`;let B,T;if(((R=l==null?void 0:l.result)==null?void 0:R.data)&&((U=l==null?void 0:l.preResult)==null?void 0:U.data)&&!((Y=(L=l==null?void 0:l.preResult)==null?void 0:L.data)!=null&&Y.emptyData)){const I=Ve((V=(z=l.preResult)==null?void 0:z.data)==null?void 0:V.latestValue,(W=(G=l.result)==null?void 0:G.data)==null?void 0:W.latestValue);B=`${Math.floor(I*100)/100*-1}%`,T=I<0?0:1}else B=v("\u5386\u53F2\u6570\u636E\u4E0D\u8DB3"),T=2;return a!=null&&a.isError&&ae.error(`[${e}] Check Your Network Or Query Params !!!`),o(le,{loading:a==null?void 0:a.isFetching,header:y("div",{className:i.boardTitle,children:[e,o("span",{style:{marginLeft:"5px"},children:o(he,{content:o("p",{style:{fontWeight:"normal"},children:b}),placement:"top",children:o(de,{})})})]}),className:S({[i.boardPanelDark]:s}),bordered:_,footer:y("div",{className:i.boardItemBottom,children:[y("div",{className:i.boardItemDesc,children:[r,o(ze,{trend:T,trendNum:B})]}),o(_e,{className:i.boardItemIcon})]}),children:y("div",{className:i.boardItem,children:[o("div",{className:i.boardItemLeft,children:A}),o("div",{className:i.boardItemRight,children:n||(D==null?void 0:D.Icon)})]})})};var We=h.memo(Ge);const He=()=>{const{t:e}=k(),t=ce(),r=[{title:e("\u5F53\u6708\u603B\u6210\u672C"),countPrefix:"\xA5 ",lineColor:"#fff",query:`sum (
      avg(
          sum_over_time(node:node_total_hourly_cost:avg[30d])
          * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)
      )

  by (node)) * (${t}/100.0)`,timeType:F.Range,tips:e("\u8FC7\u53BB\u4E00\u4E2A\u6708\u96C6\u7FA4\u603B\u6210\u672C\u3002\u4ECE\u5B89\u88C5Crane\u65F6\u95F4\u5F00\u59CB\uFF0C\u6309\u5C0F\u65F6\u7D2F\u52A0\u96C6\u7FA4\u6210\u672C")},{title:e("\u9884\u4F30\u6BCF\u6708\u6210\u672C"),countPrefix:"\xA5 ",query:`sum (
      avg(
          avg_over_time(node_total_hourly_cost[1h])
          * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)
      )

  by (node)) * 730 * (${t}/100.0)`,timeType:F.Range,tips:e("\u4EE5\u6700\u8FD1\u4E00\u5C0F\u65F6\u6210\u672C\u4F30\u7B97\u672A\u6765\u4E00\u4E2A\u6708\u7684\u6210\u672C\u3002\u6BCF\u5C0F\u65F6\u6210\u672C * 24 * 30")},{title:e("\u9884\u4F30CPU\u603B\u6210\u672C"),query:`sum(
    sum(kube_pod_container_resource_requests{resource="cpu", unit="core"}) by (container, pod, node, namespace)
    * on (node) group_left()
    avg(
        avg_over_time(node_cpu_hourly_cost[1h]) * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet",label_node_kubernetes_io_instance_type!~"eklet"}
        ) by (node)
    ) by (node)
  ) * 730 * (${t}/100.)`,countPrefix:"\xA5 ",timeType:F.Range,tips:e("\u4EE5\u6700\u8FD1\u4E00\u5C0F\u65F6CPU\u6210\u672C\u4F30\u7B97\u672A\u6765\u4E00\u4E2A\u6708\u7684CPU\u6210\u672C\u3002\u6BCF\u5C0F\u65F6CPU\u6210\u672C * 24 * 30")},{title:e("\u9884\u4F30Memory\u603B\u6210\u672C"),query:`sum(
    sum(kube_pod_container_resource_requests{resource="memory", unit="byte", namespace!=""} / 1024./ 1024. / 1024.) by (container, pod, node, namespace) * on (node) group_left()
    avg(
      avg_over_time(node_ram_hourly_cost[1h]) * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet", label_node_kubernetes_io_instance_type!~"eklet"}
      ) by (node)
    ) by (node)
  ) * 730 * (${t}/100.)`,countPrefix:"\xA5 ",timeType:F.Range,tips:e("\u4EE5\u6700\u8FD1\u4E00\u5C0F\u65F6Memory\u6210\u672C\u4F30\u7B97\u672A\u6765\u4E00\u4E2A\u6708\u7684Memory\u6210\u672C\u3002\u6BCF\u5C0F\u65F6Memory\u6210\u672C * 24 * 30")}];return o(P,{gutter:[16,16],children:r.map((n,s)=>o(C,{xs:6,xl:3,children:o(We,{title:n.title,trend:n.trend,trendNum:n.trendNum,count:n.count,countPrefix:n.countPrefix,lineColor:n.lineColor,desc:e("\u81EA\u4ECE\u4E0A\u5468\u4EE5\u6765"),Icon:n.Icon,dark:s===0,query:n.query,timeType:n.timeType,start:n.start,end:n.end,step:n.step,tips:n.tips})},n.title))})};var Ke=h.memo(He);const Qe="_middleChartPanel_1ui44_1";var Xe={middleChartPanel:Qe};const Je=(e,t,r,n,s)=>{var x;const _=c(r[0]).valueOf(),u=c(r[1]).valueOf(),m=Math.round((u-_)/1e3/60);s=s.replaceAll("{DURATION}",m.toString());const{data:p,isError:f}=se({craneUrl:e,start:_,end:u,step:n,query:s});if(f&&ae.error(`[${t}] Check Your Network Or Query Params !!!`),f)return{};const g={};return(x=p==null?void 0:p.data)==null||x.map(b=>{var v;const O=b.metric.namespace;return((v=b==null?void 0:b.values)!=null?v:[]).map(l=>{const a=c(l[0]).format("MM-DD"),j=l[1];typeof g[a]!="object"&&(g[a]=[]);const D={name:O,value:j};return g[a].push(D),l}),b}),g},Ze=({title:e,subTitle:t,datePicker:r,timeRange:n,step:s,query:_})=>{const{t:u}=k(),m=ue();let p,f;n!=null?[p,f]=d.exports.useState([c().subtract(n,"s").format("YYYY-MM-DD"),c().subtract(0,"s").format("YYYY-MM-DD HH:mm:ss")]):[p,f]=d.exports.useState([c().subtract(7,"days").format("YYYY-MM-DD"),c().subtract(0,"s").format("YYYY-MM-DD HH:mm:ss")]);const[g]=d.exports.useState({[u("\u6700\u8FD17\u5929")]:[c().subtract(7,"day").toDate(),c().toDate()],[u("\u6700\u8FD13\u5929")]:[c().subtract(3,"day").toDate(),c().toDate()],[u("\u6700\u8FD12\u5929")]:[c().subtract(2,"day").toDate(),c().toDate()],[u("\u6700\u8FD11\u5929")]:[c().subtract(1,"day").toDate(),c().toDate()],[u("\u5B9E\u65F6")]:[c().toDate(),c().toDate()]}),x=a=>{console.log(a),f(a)},b=Je(m,e!=null?e:"",p,s!=null?s:"",_),O=[],v=[];Object.keys(b).map(a=>O.push(a)&&v.push({series:[{data:b[a]}]}));const l={tooltip:{trigger:"item"},grid:{top:"0",right:"0"},legend:{type:"scroll",top:"bottom",left:"center"},label:{show:!1,position:"center"},timeline:{show:!1,currentIndex:Object.keys(b).length-1,bottom:"0",axisType:"category",data:O},series:[{type:"pie",height:"90%",label:{show:!1}}],options:v};return o(le,{title:e,subtitle:t,actions:r&&o(ke,{attach:"body",content:o(fe,{mode:"date",placeholder:[u("\u5F00\u59CB\u65F6\u95F4"),u("\u7ED3\u675F\u65F6\u95F4")],enableTimePicker:!0,value:p,format:"YYYY-MM-DD HH:mm",presets:g,onChange:x}),destroyOnClose:!1,hideEmptyPopup:!1,placement:"top",showArrow:!1,trigger:"hover",children:o(pe,{})}),children:o(ie,{option:l,notMerge:!0,lazyUpdate:!0})})};var et=h.memo(Ze);const tt=()=>{const{t:e}=k(),t=ce();return y(P,{gutter:[16,16],className:Xe.middleChartPanel,children:[o(C,{xs:12,xl:9,children:o(w,{title:e("\u6210\u672C\u8D70\u52BF"),subTitle:e("( \u5143 )"),datePicker:!0,step:"1h",tips:e("\u8FC7\u53BB\u4E00\u6BB5\u65F6\u95F4\u5185\u7684\u6210\u672C\u8D70\u52BF\u56FE"),lines:[{name:e("\u603B\u6210\u672C"),query:`(sum(sum_over_time(node:node_total_hourly_cost:avg[1h]) * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)))
              * (${t}/100.0)`},{name:e("\u7533\u8BF7\u8D44\u6E90\u6210\u672C"),query:`sum(
  sum(
    sum(kube_pod_container_resource_requests{resource="cpu", unit="core"}) by (container, pod, node, namespace)
    * on (node) group_left()
    avg(
      avg_over_time(node_cpu_hourly_cost[1h]) * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet",label_node_kubernetes_io_instance_type!~"eklet"}) by (node)
    ) by (node)

)

+

sum(
  sum(kube_pod_container_resource_requests{resource="memory", unit="byte", namespace!=""} / 1024./ 1024. / 1024.) by (container, pod, node, namespace)
  * on (node) group_left()
  avg(
    avg_over_time(node_ram_hourly_cost[1h]) * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)
  ) by (node)

)
) * (${t}/100.0)`}]})}),o(C,{xs:12,xl:3,children:o(et,{title:e("\u547D\u540D\u7A7A\u95F4\u6210\u672C\u5206\u5E03"),datePicker:!0,step:"24h",query:`sum(sum_over_time(namespace:container_cpu_usage_costs_hourly:sum_rate{}[{DURATION}m]) + sum_over_time(namespace:container_memory_usage_costs_hourly:sum_rate{}[{DURATION}m])) by (namespace) * (${t}/100.0)`})})]})};var nt=h.memo(tt);const rt="_cpuChartPanel_1fqt9_1";var ot={cpuChartPanel:rt};const at=()=>{const{t:e}=k(),t={title:e("CPU \u8D44\u6E90\u4F7F\u7528"),subTitle:"(Core)",datePicker:!0,step:"1h",xAxis:{type:"time"},lines:[{name:"capacity",query:'SUM(kube_node_status_capacity{resource="cpu", unit="core"}  * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node))'},{name:"request",query:'SUM(kube_pod_container_resource_requests{resource="cpu", unit="core"}  * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node))'},{name:"limit",query:'SUM(kube_pod_container_resource_limits{resource="cpu", unit="core"}  * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node))'},{name:"usage",query:'sum(label_replace(irate(container_cpu_usage_seconds_total{id="/"}[5m]), "node", "$1", "instance",  "(^[^:]+)") * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!~"eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node))'}]};return o(P,{gutter:[16,16],className:ot.cpuChartPanel,children:o(C,{span:12,children:o(w,{title:t.title,subTitle:t.subTitle,datePicker:t.datePicker,lines:t.lines,timeRange:t.timeRange,step:t.step,xAxis:t.xAxis})})})};var st=h.memo(at);const ut="_memoryChartPanel_5sfee_1";var lt={memoryChartPanel:ut};const it=()=>{const{t:e}=k(),t={title:e("Memory \u8D44\u6E90\u4F7F\u7528"),subTitle:"( GB )",datePicker:!0,step:"1h",xAxis:{type:"time"},lines:[{name:"capacity",query:'SUM(kube_node_status_capacity{resource="memory", unit="byte"}  * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)  / 1024 / 1024 / 1024 )'},{name:"request",query:'SUM(kube_pod_container_resource_requests{resource="memory", unit="byte", namespace!=""} * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)/ 1024 / 1024 / 1024)'},{name:"limits",query:'SUM(kube_pod_container_resource_limits{resource="memory", unit="byte", namespace!=""} * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node) / 1024 / 1024 / 1024)'},{name:"usage",query:'SUM(label_replace(container_memory_working_set_bytes{id="/"}, "node", "$1", "instance",  "(^[^:]+)")  * on (node) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (node)) / 1024 / 1024 / 1024'}]};return o(P,{gutter:[16,16],className:lt.memoryChartPanel,children:o(C,{span:12,children:o(w,{title:t.title,subTitle:t.subTitle,datePicker:t.datePicker,lines:t.lines,timeRange:t.timeRange,step:t.step,xAxis:t.xAxis})})})};var ct=h.memo(it);const _t="_diskIoChartPanel_dxxw9_1";var dt={diskIoChartPanel:_t};const pt=()=>{const{t:e}=k(),t={title:e("\u78C1\u76D8 IO \u4F7F\u7528"),subTitle:"(bytes/second)",datePicker:!0,step:"1h",xAxis:{type:"time"},lines:[{name:"read_bytes",query:'sum(rate(node_disk_read_bytes_total[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'},{name:"written_bytes",query:'sum(rate(node_disk_written_bytes_total{device!~"dm-.*"}[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'},{name:"io_time",query:'sum(rate(node_disk_io_time_seconds_total{device!~"dm-.*"}[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'}]};return o(P,{gutter:[16,16],className:dt.diskIoChartPanel,children:o(C,{span:12,children:o(w,{title:t.title,subTitle:t.subTitle,datePicker:t.datePicker,lines:t.lines,timeRange:t.timeRange,step:t.step,xAxis:t.xAxis})})})};var bt=h.memo(pt);const mt="_networkIoChartPanel_xehv5_1";var yt={networkIoChartPanel:mt};const ht=()=>{const{t:e}=k(),t={title:e("\u7F51\u7EDC IO \u4F7F\u7528"),subTitle:"(bytes/second)",datePicker:!0,step:"1h",xAxis:{type:"time"},lines:[{name:"receive_bytes",query:'sum(rate(node_network_receive_bytes_total{device!~"veth.*|docker.*|cni.*|flannel.*|cali.*|cbr.*"}[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'},{name:"transmit_bytes",query:'sum(rate(node_network_transmit_bytes_total{device!~"veth.*|docker.*|cni.*|flannel.*|cali.*|cbr.*"}[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'},{name:"receive_packets",query:'sum(rate(node_network_receive_packets_total{device!~"veth.*|docker.*|cni.*|flannel.*|cali.*|cbr.*"}[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'},{name:"transmit_packets",query:'sum(rate(node_network_transmit_packets_total{device!~"veth.*|docker.*|cni.*|flannel.*|cali.*|cbr.*"}[5m]) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance))'}]};return o(P,{gutter:[16,16],className:yt.networkIoChartPanel,children:o(C,{span:12,children:o(w,{title:t.title,subTitle:t.subTitle,datePicker:t.datePicker,lines:t.lines,timeRange:t.timeRange,step:t.step,xAxis:t.xAxis})})})};var kt=h.memo(ht);const ft="_gpuChartPanel_1fqta_1";var gt={gpuChartPanel:ft};const Ct=()=>{const{t:e}=k(),t={title:e("GPU \u8D44\u6E90\u4F7F\u7528"),subTitle:"(%)",datePicker:!0,step:"1h",xAxis:{type:"time"},lines:[{name:"capacity",query:'sum(DCGM_FI_DEV_GPU_UTIL) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance)'},{name:"memory_used",query:'sum(DCGM_FI_DEV_FB_USED / DCGM_FI_DEV_FB_TOTAL * 100) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance)'},{name:"power_usage",query:'sum(DCGM_FI_DEV_POWER_USAGE / DCGM_FI_DEV_POWER_LIMIT * 100) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance)'},{name:"temperature",query:'sum(DCGM_FI_DEV_GPU_TEMP) * on (instance) group_left() max(kube_node_labels{label_beta_kubernetes_io_instance_type!="eklet", label_node_kubernetes_io_instance_type!~"eklet"}) by (instance)'}]};return o(P,{gutter:[16,16],className:gt.gpuChartPanel,children:o(C,{span:12,children:o(w,{title:t.title,subTitle:t.subTitle,datePicker:t.datePicker,lines:t.lines,timeRange:t.timeRange,step:t.step,xAxis:t.xAxis})})})};var vt=h.memo(Ct);const Pt=()=>y("div",{style:{overflowX:"hidden"},children:[o(Ke,{}),o(nt,{}),o(st,{}),o(ct,{}),o(kt,{}),o(vt,{}),o(bt,{})]});var Et=d.exports.memo(Pt);export{Et as default};
